<!DOCTYPE html>



<style>

    body {
        background-color: #f0f8ff;
        background-color: rgb(220, 228, 245);
    }

    #gameContainer {
        width: 50%;
        height: 100%;
        display: flex;
        flex-direction: column;
        max-width: 500px;
        min-width: 300px;

    }

    .gameTextArea {

        padding: 7px;
        background: gray;
        color: white;
        font-family: monospace;

    }

    #gameHeaderArea {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        width: 100%;
        height: 30px;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }

    #gameStatsArea {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        width: 35%;
    }

    #gameArea {
        width: 100%;
        height: auto;
        min-height: 200px;
        max-height: 400px;
        overflow: auto;

    }

    #previousInputArea {
        width: 100%;
        height: 20px;
        border-bottom-left-radius: 5px;
        border-bottom-right-radius: 5px;
    }

    #inputTextArea {
        width: 100%;
        border-radius: 5px;
        padding: 7px;
        margin-top: 10px;
        border: 1px;
        font-family: monospace;
        font-weight: 1200;
        background: black;
        color: white;

    }

</style>

<html>
<head>
    <title>Zork</title>
    <meta charset="utf-8">

</head>
<body>

    <div id="gameContainer">
        <div id="gameHeaderArea" class="gameTextArea">
            <div id="gameLocationArea"></div>
            <div id="gameStatsArea">
                <div id="gameTurnsArea">Turns: 0</div>
                <div id="gameScoreArea">Score: 0</div>
            </div>
        </div>
        <div id="gameArea" class="gameTextArea"></div>
        <div id="previousInputArea" class="gameTextArea"></div>
        <input type="text" id="inputTextArea" name="playerInput" tabindex="0" spellcheck="false" autofocus="true">
        <div style="margin-top: 100px"><a href="index.html">Home</a></div>
    </div>

    <script type="text/javascript" src="zconstants.js"></script>
    <script type="text/javascript" src="mapstrings.js"></script>
    <script type="text/javascript" src="objectstrings.js"></script>
    <script type="text/javascript" src="gamestrings.js"></script>
    <script type="text/javascript" src="zstate.js"></script>

    <script type="text/javascript">
        
        let state = new GameState();

        function clearOutput()
        {
            document.getElementById("gameArea").innerText = "";
        }

        function getRandom(int)
        {
            return Math.floor(Math.random() * int);
        }


        function setup()
        {
            const inp = document.getElementById("inputTextArea");
            // inp.addEventListener("change", reverseInput);
        }

        function output(str)
        {
            if (state.directObject != null && state.indirectObject != null)
            {
                str = str.replace(/ENEMY/g, state.directObject.name);
                str = str.replace(/ITEM/g,  state.indirectObject.name);
                str = str.replace(/WEAPON/g,  state.indirectObject.name);
            }


            let txt = document.getElementById("gameArea").innerText;

            if (txt === "")
            {
                txt = str;
            }

            else
            {
                txt += "\n" + str;
            }

            document.getElementById("gameArea").innerText = txt;
            
        }

        function outputLocation(str)
        {
            document.getElementById("gameLocationArea").innerText = str;
        }

        function outputPreviousInput(str)
        {
            document.getElementById("previousInputArea").innerText = ">> " + str;

        }

        function outputScore(str)
        {
            document.getElementById("gameScoreArea").innerText = "Score: " + str;
        }

        function outputTurns(str)
        {
            document.getElementById("gameTurnsArea").innerText = "Turns: " + str;
        }

        setup();

    </script>

    <script type="text/javascript" src="zobject.js"></script>
    <script type="text/javascript" src="actor.js"></script>
    <script type="text/javascript" src="container.js"></script>
    <script type="text/javascript" src="feature.js"></script>
    <script type="text/javascript" src="item.js"></script>
    <script type="text/javascript" src="surface.js"></script>
    <script type="text/javascript" src="passage.js"></script>
    <script type="text/javascript" src="room.js"></script>
    <script type="text/javascript" src="zsetup.js"></script>

    <script type="text/javascript">
        
        state.playerLocation = Location.WEST_OF_HOUSE;

        const savedStates = [];

        let savedState = new GameState();
        let savedObjects = new Map();

        savedState = Object.assign(savedState, state);
        for (let key of objectList.keys())
        {
            let sourceObject = objectList.get(key);
            let savedObject = null;

            switch (sourceObject.objectType)
            {
                case "ACTOR":
                {
                    savedObject = new Actor(sourceObject.name, sourceObject.location);
                    savedObject = Object.assign(savedObject, sourceObject);
                } break;

                case "CONTAINER":
                {
                    savedObject = new Container(sourceObject.name, sourceObject.location);
                    savedObject = Object.assign(savedObject, sourceObject);
                } break;

                case "FEATURE":
                {
                    savedObject = new Feature(sourceObject.name, sourceObject.location);
                    savedObject = Object.assign(savedObject, sourceObject);
                } break;

                case "ITEM":
                {
                    savedObject = new Item(sourceObject.name, sourceObject.location);
                    savedObject = Object.assign(savedObject, sourceObject);
                } break;

                case "SURFACE":
                {
                    savedObject = new Surface(sourceObject.name, sourceObject.location);
                    savedObject = Object.assign(savedObject, sourceObject);
                } break;
            }

            savedObjects.set(key, savedObject);
        }

        savedStates.push( {savedState, savedObjects} );

    </script>

    <script type="text/javascript" src="zinput.js"></script>
    <script type="text/javascript" src="zupdate.js"></script>

    <script type="text/javascript">

    
        refreshInventories();
        fillCurrentObjectList();
        fillDictionary();
        
        outputLocation(westOfHouse.name);
        westOfHouse.lookAround();

        state.resetInput();
        inputTextArea.addEventListener("change", parsePlayerInput);

    </script>


</body>
</html>